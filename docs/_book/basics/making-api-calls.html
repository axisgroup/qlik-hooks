
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Making API Calls Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="error-handling.html" />
    
    
    <link rel="prev" href="connecting.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Qlik Hooks v0.4
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Introduction
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../introduction/why-hooks.html">
            
                <a href="../introduction/why-hooks.html">
            
                    
                    Why Hooks?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../introduction/qlik-hooks-vs-rxq-vs-enigma.html">
            
                <a href="../introduction/qlik-hooks-vs-rxq-vs-enigma.html">
            
                    
                    Qlik Hooks vs. RxQ vs. Enigma
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../introduction/core-concepts.html">
            
                <a href="../introduction/core-concepts.html">
            
                    
                    Core Concepts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="../introduction/qae-hierarchy.html">
            
                <a href="../introduction/qae-hierarchy.html">
            
                    
                    QAE Hierarchy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Basics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="connecting.html">
            
                <a href="connecting.html">
            
                    
                    Connecting
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.2" data-path="making-api-calls.html">
            
                <a href="making-api-calls.html">
            
                    
                    Making API Calls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="error-handling.html">
            
                <a href="error-handling.html">
            
                    
                    Error Handling
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="initializing-api-calls.html">
            
                <a href="initializing-api-calls.html">
            
                    
                    Initializing API Calls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="invalidations.html">
            
                <a href="invalidations.html">
            
                    
                    Invalidations
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Recipes
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../recipes/connect.html">
            
                <a href="../recipes/connect.html">
            
                    
                    01. Connect to an Engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../recipes/engine-version.html">
            
                <a href="../recipes/engine-version.html">
            
                    
                    02. Get the Engine Version
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../recipes/multiple-global-calls.html">
            
                <a href="../recipes/multiple-global-calls.html">
            
                    
                    03. Make Multiple Global Calls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../recipes/open-an-app.html">
            
                <a href="../recipes/open-an-app.html">
            
                    
                    04. Open an App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../recipes/read-app-props.html">
            
                <a href="../recipes/read-app-props.html">
            
                    
                    05. Get App Properties
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../recipes/set-app-props.html">
            
                <a href="../recipes/set-app-props.html">
            
                    
                    06. Set App Properties and Listen for Changes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../recipes/gen-obj-value.html">
            
                <a href="../recipes/gen-obj-value.html">
            
                    
                    07. Calculate a Value with a GenericObject
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../recipes/current-selections.html">
            
                <a href="../recipes/current-selections.html">
            
                    
                    08. Get a stream of Current Selections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../recipes/make-a-selection.html">
            
                <a href="../recipes/make-a-selection.html">
            
                    
                    09. Make a Selection in a Field
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../recipes/loop-selections.html">
            
                <a href="../recipes/loop-selections.html">
            
                    
                    10. Loop Through Selections in a Field
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="../recipes/make-lb-selections.html">
            
                <a href="../recipes/make-lb-selections.html">
            
                    
                    11. Make Selections in a Listbox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="../recipes/search-lb.html">
            
                <a href="../recipes/search-lb.html">
            
                    
                    12. Search in a Listbox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.13" data-path="../recipes/apply-patches.html">
            
                <a href="../recipes/apply-patches.html">
            
                    
                    13. Apply Patches to an Object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.14" data-path="../recipes/get-data-page-on-invalid.html">
            
                <a href="../recipes/get-data-page-on-invalid.html">
            
                    
                    14. Get a page of data in a HyperCube on invalidation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.15" data-path="../recipes/get-pages-in-parallel.html">
            
                <a href="../recipes/get-pages-in-parallel.html">
            
                    
                    15. Get pages of data in parallel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.16" data-path="../recipes/get-pages-in-sequence.html">
            
                <a href="../recipes/get-pages-in-sequence.html">
            
                    
                    16. Get pages of data sequentially
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.17" data-path="../recipes/make-selections-on-app-open.html">
            
                <a href="../recipes/make-selections-on-app-open.html">
            
                    
                    17. Make selections on app open
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.18" data-path="../recipes/calc-time.html">
            
                <a href="../recipes/calc-time.html">
            
                    
                    18. Calculate the duration of an API call and response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.19" data-path="../recipes/toggle-sessions.html">
            
                <a href="../recipes/toggle-sessions.html">
            
                    
                    20. Toggle Calculations Between Multiple Apps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.20" data-path="../recipes/offline.html">
            
                <a href="../recipes/offline.html">
            
                    
                    21. Auto-reconnect Generic Objects after a network drop
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Making API Calls</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="making-api-calls">Making API Calls</h1>
<p>When we have a Qlik Sense Object Handle, we can call any API method from the Class the handle belongs to. When we connect to the engine and receive an object back, it contains a handle of the Global class type. We can then call any Global Class API method with our object.</p>
<p>Remember, whenever we use a Qlik Hook, it must follow the rules of <a href="https://reactjs.org/docs/hooks-rules.html" target="_blank">React Hooks</a>. That means Qlik Hooks should be called from within a React function component, or another custom React hook, and should never be called from inside a loop, a condition block, or a nested function.</p>
<h2 id="using-an-api-qlik-hook">Using an API Qlik Hook</h2>
<p>Say we have connected to Qlik Engine:</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">const</span> Component = () =&gt; {
  <span class="hljs-keyword">const</span> engine = useConnectEngine({
    host: <span class="hljs-string">&quot;sense.axisgroup.com&quot;</span>,
    isSecure: <span class="hljs-literal">true</span>,
  })

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>...component content<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
</code></pre>
<p>The <code>engine</code> object we get back contains a handle of the Global class type that can be used in conjunction with any of the Global API methods. Let&apos;s see how we can use this to get the version of our Qlik Engine. First, we need to import the EngineVersion API hook method from the qlik-hooks library</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">import</span> { useEngineVersion } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;qlik-hooks/Global&quot;</span>
</code></pre>
<p>Now we can run the useEngineVersion hook in our React component, passing in the Handle object we are running the method against</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">const</span> Component = () =&gt; {
  <span class="hljs-keyword">const</span> engineVersion = useEngineVersion(engine)
  <span class="hljs-built_in">console</span>.log(engineVersion)
}
</code></pre>
<p>We can see this object contains 3 properties: the loading state, the response from the Qlik Engine, and a function to actually call the api method. At this point in time, the API call has been set up, but the request has not yet been sent to the engine. We can also see that qResponse is null, again because we have not yet sent the request. Let&apos;s introduce a method for an end user to call the api method.</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">const</span> Component = () =&gt; {
  useEffect(() =&gt; {
    <span class="hljs-built_in">console</span>.log(engineVersion)
  }, [engineVersion])

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">button</span> <span class="hljs-attr">onClick</span>=<span class="hljs-string">{()</span> =&gt;</span> engineVersion.call()}&gt;Get Engine Version<span class="hljs-tag">&lt;/<span class="hljs-name">button</span>&gt;</span></span>
}
</code></pre>
<p>When we interact with the button, the EngineVersion method is called, and the engineVersion object temporarily goes into a loading state (with loading set to true) until it finally receives and stores the response from Qlik in the qResponse property.</p>
<p>This is a good start, but what if we don&apos;t want to require user interaction to call this API method. Instead we want to just call this method once and have its value. This can be done by calling the useConnectEngine hook with a second input, an object containing the params array that gets passed to the engine with the api call.</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">const</span> Component = () =&gt; {
  <span class="hljs-keyword">const</span> engineVersion = useEngineVersion(engine, { params: [] })
  <span class="hljs-built_in">console</span>.log(engineVersion)

  <span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>
}
</code></pre>
<p>Initially, engineVersion is set to the same state we see in the first example without params initialization, but this time the hook has sent the api request to the engine already, and will soon after get the response back. Initializing an API hook with params doesn&apos;t necessarily mean the method call has to be one-and-done. We can still use the call function on the engineVersion object to keep calling the api method at any point in the future.</p>
<h2 id="asynchronous-object-calls">Asynchronous Object Calls</h2>
<p>It is important to understand that the API method calls occuring in Qlik Hooks happen asynchronously. When we call a method such as <code>useEngineVersion</code>, a request is sent to the engine asking for the version, but before the version is returned, our code will continue to run. Because of this, we can&apos;t do anything with our engineVersion object until its state updates with the qResponse we need.</p>
<p>If inside a React component we were to run this code:</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">const</span> Component = () =&gt; {
  <span class="hljs-keyword">const</span> engineVersion = useEngineVersion(engine, { params: [] })

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{engineVersion.qResponse.qComponentVersion}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
</code></pre>
<p>we would get an error because the qResponse property on engineVersion initially has a value of null. It&apos;s not until a short time later that the engineVersion state gets updated with the response from the engine.</p>
<p>We instead need to implement our code to check for a valid qResponse before trying to use the data within.</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">const</span> Component = () =&gt; {
  <span class="hljs-keyword">const</span> engineVersion = useEngineVersion(engine, { params: [] })

  <span class="hljs-keyword">return</span> engineVersion.qResponse !== <span class="hljs-literal">null</span> ? (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{engineVersion.qResponse.qComponentVersion}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  ) : (
    <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>loading...<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
  )
}
</code></pre>
<h2 id="connecting-handles">Connecting Handles</h2>
<p>The previous section demonstrates an example of calling an Action Qlik Hook, but what if we want to connect to a new Handle object that has its own set of class API methods. This is necessary if we want to open a Qlik Application, or create new objects within an app that calculate data tables (take a look at the <a href="../introduction/qae-hierarchy.html">QAE Class Hierarchy</a> for a refresher on class layouts).</p>
<p>Connecting to an application would look something like this</p>
<pre><code class="lang-jsx"><span class="hljs-keyword">import</span> { useConnectEngine } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;qlik-hooks&quot;</span>
<span class="hljs-keyword">import</span> { useOpenDoc } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;qlik-hooks/Global&quot;</span>

<span class="hljs-keyword">const</span> Component = () =&gt; {
  <span class="hljs-keyword">const</span> engine = useConnectEngine({
    host: <span class="hljs-string">&quot;sense.axisgroup.com&quot;</span>,
    isSecure: <span class="hljs-literal">true</span>,
  })

  <span class="hljs-keyword">const</span> doc = useOpenDoc(engine, { params: [<span class="hljs-string">&quot;aae16724-dfd9-478b-b401-0d8038793adf&quot;</span>] })

  <span class="hljs-keyword">return</span> <span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>component content<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>
}
</code></pre>
<p>Now, we have a doc object that contains a handle of the type Doc, and we can run any Doc API class.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="connecting.html" class="navigation navigation-prev " aria-label="Previous page: Connecting">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="error-handling.html" class="navigation navigation-next " aria-label="Next page: Error Handling">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Making API Calls","level":"1.3.2","depth":2,"next":{"title":"Error Handling","level":"1.3.3","depth":2,"path":"basics/error-handling.md","ref":"basics/error-handling.md","articles":[]},"previous":{"title":"Connecting","level":"1.3.1","depth":2,"path":"basics/connecting.md","ref":"basics/connecting.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["livereload"],"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"basics/making-api-calls.md","mtime":"2020-02-01T02:51:59.396Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-05-27T17:38:40.536Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

