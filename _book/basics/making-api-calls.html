
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Making API Calls Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="reusing-handles.html" />
    
    
    <link rel="prev" href="connecting.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Qlik Hooks v0.1.0
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Introduction
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../introduction/why-hooks.html">
            
                <a href="../introduction/why-hooks.html">
            
                    
                    Why Hooks?
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../introduction/rxq-vs-enigma.html">
            
                <a href="../introduction/rxq-vs-enigma.html">
            
                    
                    RxQ vs. Enigma
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../introduction/core-concepts.html">
            
                <a href="../introduction/core-concepts.html">
            
                    
                    Core Concepts
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" >
            
                <span>
            
                    
                    Basics
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="connecting.html">
            
                <a href="connecting.html">
            
                    
                    Connecting
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3.2" data-path="making-api-calls.html">
            
                <a href="making-api-calls.html">
            
                    
                    Making API Calls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="reusing-handles.html">
            
                <a href="reusing-handles.html">
            
                    
                    Reusing Handles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="handle-invalidations.html">
            
                <a href="handle-invalidations.html">
            
                    
                    Handle Invalidations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="suspending-invalidations.html">
            
                <a href="suspending-invalidations.html">
            
                    
                    Suspending Invalidations
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="closing-a-session.html">
            
                <a href="closing-a-session.html">
            
                    
                    Closing a Session
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="notifications.html">
            
                <a href="notifications.html">
            
                    
                    Notifications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.8" data-path="delta.html">
            
                <a href="delta.html">
            
                    
                    Delta Mode
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.9" data-path="shortcut-operators.html">
            
                <a href="shortcut-operators.html">
            
                    
                    Shortcut Operators
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Recipes
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../recipes/connect.html">
            
                <a href="../recipes/connect.html">
            
                    
                    01. Connect to an Engine
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../recipes/engine-version.html">
            
                <a href="../recipes/engine-version.html">
            
                    
                    02. Get the Engine Version
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../recipes/multiple-global-calls.html">
            
                <a href="../recipes/multiple-global-calls.html">
            
                    
                    03. Make Multiple Global Calls
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../recipes/open-an-app.html">
            
                <a href="../recipes/open-an-app.html">
            
                    
                    04. Open an App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../recipes/read-app-props.html">
            
                <a href="../recipes/read-app-props.html">
            
                    
                    05. Get App Properties
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" data-path="../recipes/set-app-props.html">
            
                <a href="../recipes/set-app-props.html">
            
                    
                    06. Set App Properties and Listen for Changes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.7" data-path="../recipes/gen-obj-value.html">
            
                <a href="../recipes/gen-obj-value.html">
            
                    
                    07. Calculate a Value with a GenericObject
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.8" data-path="../recipes/current-selections.html">
            
                <a href="../recipes/current-selections.html">
            
                    
                    08. Get a stream of Current Selections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.9" data-path="../recipes/make-a-selection.html">
            
                <a href="../recipes/make-a-selection.html">
            
                    
                    09. Make a Selection in a Field
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.10" data-path="../recipes/loop-selections.html">
            
                <a href="../recipes/loop-selections.html">
            
                    
                    10. Loop through Selections in a Field
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.11" data-path="../recipes/make-lb-selections.html">
            
                <a href="../recipes/make-lb-selections.html">
            
                    
                    11. Make Selections in a Listbox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.12" data-path="../recipes/search-lb.html">
            
                <a href="../recipes/search-lb.html">
            
                    
                    12. Search in a Listbox
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.13" data-path="../recipes/apply-patches.html">
            
                <a href="../recipes/apply-patches.html">
            
                    
                    13. Apply Patches to an Object
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.14" data-path="../recipes/get-data-page-on-invalid.html">
            
                <a href="../recipes/get-data-page-on-invalid.html">
            
                    
                    14. Get a page of data in a HyperCube on invalidation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.15" data-path="../recipes/get-pages-in-parallel.html">
            
                <a href="../recipes/get-pages-in-parallel.html">
            
                    
                    15. Get pages of data in parallel
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.16" data-path="../recipes/get-pages-in-sequence.html">
            
                <a href="../recipes/get-pages-in-sequence.html">
            
                    
                    16. Get pages of data sequentially
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.17" data-path="../recipes/make-selections-on-app-open.html">
            
                <a href="../recipes/make-selections-on-app-open.html">
            
                    
                    17. Make selections on app open
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.18" data-path="../recipes/calc-time.html">
            
                <a href="../recipes/calc-time.html">
            
                    
                    18. Calculate the duration of an API call and response
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.19" data-path="../recipes/batch-invalidations.html">
            
                <a href="../recipes/batch-invalidations.html">
            
                    
                    19. Batch Invalidations with Suspend
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.20" data-path="../recipes/toggle-sessions.html">
            
                <a href="../recipes/toggle-sessions.html">
            
                    
                    20. Toggle Calculations Between Multiple Apps
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.21" data-path="../recipes/offline.html">
            
                <a href="../recipes/offline.html">
            
                    
                    21. Auto-reconnect Generic Objects after a network drop
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.22" data-path="../recipes/shortcut-operators.html">
            
                <a href="../recipes/shortcut-operators.html">
            
                    
                    22. Using shortcut operators to get a layout stream
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Making API Calls</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="making-api-calls">Making API Calls</h1>
<p>As discussed in <a href="../introduction/core-concepts.html">Core Concepts</a>, RxQ provides Handle instances that have an <code>ask</code> method for executing an API call and then return an Observable for the response.</p>
<p>Any API method name can be entered via a string. However, the Qlik Engine API is vast so RxQ provides exports of method name enums for each Qlik class.</p>
<p>Let&apos;s use the <code>EngineVersion</code> method from Qlik&apos;s Global class as an example. We can import the <code>EngineVersion</code> enum from RxQ like so:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { EngineVersion } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;rxq/Global&quot;</span>;
</code></pre>
<p>To use it, we call a Global Handle&apos;s ask method with it. Then, we can subscribe to get the engine version back:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">const</span> version$ = globalHandle.ask(EngineVersion);

version$.subscribe((version) =&gt; {
    <span class="hljs-built_in">console</span>.log(version);
});
</code></pre>
<p>There&apos;s just one problem here: how do we get the Global Handle in order to make the call? Let&apos;s review.</p>
<h2 id="getting-handles">Getting Handles</h2>
<p>Handles are provided to us by QAE. Therefore, we can only receive them asychronously through some sort of API call. The Engine has several API calls that will return Handles, such as:</p>
<ul>
<li><a href="http://help.qlik.com/en-US/sense-developer/November2017/Subsystems/EngineAPI/Content/Classes/GlobalClass/Global-class-OpenDoc-method.htm" target="_blank">OpenDoc</a>, which will return a Doc Handle from a Global Handle</li>
<li><a href="http://help.qlik.com/en-US/sense-developer/November2017/Subsystems/EngineAPI/Content/Classes/AppClass/App-class-GetField-method.htm" target="_blank">GetField</a>, which will return a Field Handle from a Doc Handle</li>
</ul>
<p>RxQ automatically parses the results of Engine API calls and produces Handles for you as needed. However, this still has to happen asynchronously, so we have to write asynchronous logic to connect a Handle with an API call. This is where higher order Observables come into play.</p>
<h2 id="leveraging-higher-order-observables-for-api-calls">Leveraging Higher Order Observables for API Calls</h2>
<p>Higher Order Observables are essentially Observables of Observables. They allow us to create asynchronous data streams based on other asynchronous data streams. This concept is pertitent to us when making API calls, since we are trying to produce an async API call from an asynchronously provided Handle.</p>
<p>RxJS makes handling these higher order observables easy using operators like <a href="http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-mergeMap" target="_blank">mergeMap</a>, <a href="http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-concatMap" target="_blank">concatMap</a>, and <a href="http://reactivex.io/rxjs/class/es6/Observable.js~Observable.html#instance-method-switchMap" target="_blank">switchMap</a> to flatten them into normal Observables. </p>
<p>When using <code>connectSession</code>, the resulting Observable provides the Global Handle for the established session. By combining this Observable with the <code>switchMap</code> operator, we can get our engine version like so:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> { connectSession } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;rxq&quot;</span>;
<span class="hljs-keyword">import</span> { EngineVersion } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;rxq/Global&quot;</span>;
<span class="hljs-keyword">import</span> { switchMap } <span class="hljs-keyword">from</span> <span class="hljs-string">&quot;rxjs/operators&quot;</span>;

<span class="hljs-keyword">const</span> session = connectSession({
    host: <span class="hljs-string">&quot;localhost&quot;</span>,
    port: <span class="hljs-number">4848</span>,
    isSecure: <span class="hljs-literal">false</span>
});

<span class="hljs-keyword">const</span> global$ = session.global$;

<span class="hljs-keyword">const</span> version$ = global$.pipe(
    switchMap(handle =&gt; handle.ask(EngineVersion))
);

version$.subscribe(version =&gt; {
    <span class="hljs-built_in">console</span>.log(version);
});
</code></pre>
<p>We commonly use <code>switchMap</code> when utilizing RxQ because we often only care about making an API call on the latest Handle provided. For more on higher order observables, <a href="https://egghead.io/courses/use-higher-order-observables-in-rxjs-effectively" target="_blank">we recommend this course</a>.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="connecting.html" class="navigation navigation-prev " aria-label="Previous page: Connecting">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="reusing-handles.html" class="navigation navigation-next " aria-label="Next page: Reusing Handles">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Making API Calls","level":"1.3.2","depth":2,"next":{"title":"Reusing Handles","level":"1.3.3","depth":2,"path":"basics/reusing-handles.md","ref":"basics/reusing-handles.md","articles":[]},"previous":{"title":"Connecting","level":"1.3.1","depth":2,"path":"basics/connecting.md","ref":"basics/connecting.md","articles":[]},"dir":"ltr"},"config":{"plugins":["livereload"],"root":"./docs","styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"livereload":{},"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"gitbook":"*"},"file":{"path":"basics/making-api-calls.md","mtime":"2020-01-28T23:28:34.083Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-01-29T15:54:56.393Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

